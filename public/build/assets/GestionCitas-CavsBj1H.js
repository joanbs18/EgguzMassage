import{r as e,a as r,u as t,j as a}from"./main-TMu7r4j7.js";import{D as i,P as s,T as o}from"./Delete-BkyaD7gm.js";import{T as n}from"./Table-BPx89Zts.js";import{T as c}from"./Titulo-DdRxg6aV.js";import{F as l}from"./FormCita-CgGJeaHo.js";import{P as d}from"./index-BpOHeROo.js";import{s as m}from"./index-D5cljlYI.js";import"./asyncToGenerator-DX3FKLjN.js";import"./context-DXfS8Ex2.js";import"./index-DVcNaHlo.js";import"./index-D44HQ0ap.js";import"./PurePanel-Dki21GvB.js";import"./ContextIsolator-BekeklBG.js";import"./UnstableContext-COzKTUEN.js";import"./roundedArrow-CFp4R6hd.js";import"./ActionButton-H1dhOI7V.js";function h(){const[h,j]=e.useState(""),x=r(),{data:p,error:u,isLoading:y}=t({queryKey:["citas"],queryFn:async()=>{const e=await fetch("https://egguzmassage.com/api/citas");if(!e.ok)throw new Error("Error al obtener los datos");return e.json()}}),{citasHoy:C,errorCitasHoy:f,isLoadingCitasHoy:g}=t({queryKey:["citasHoy"],queryFn:async()=>{const e=await fetch("https://egguzmassage.com/api/citas/hoy");if(!e.ok)throw new Error("Error al obtener los datos");return e.json()}}),b=async e=>{try{if(!(await fetch(`https://egguzmassage.com/api/citas/${e}`,{method:"DELETE"})).ok)throw new Error("Error al eliminar la cita");m.success("Cita eliminada correctamente"),await x.invalidateQueries(["citas"])}catch(r){m.error("No se pudo eliminar la cita")}},E=(null==p?void 0:p.filter((e=>e.cliente_nombre.toLowerCase().includes(h.toLowerCase())||e.fecha.includes(h)||e.hora.includes(h))))||[],_=[{key:"1",label:"Gestión de citas",children:a.jsxs(a.Fragment,{children:[a.jsx("input",{type:"text",placeholder:"Buscar cita...",value:h,onChange:e=>j(e.target.value),style:{marginBottom:"20px",padding:"10px",borderRadius:"5px",border:"1px solid #ccc"}}),a.jsx(n,{data:E,columns:["Cliente","Servicio","Motivo","Fecha","Hora","Correo","Teléfono","Estado","Acción"],renderRow:(e,r)=>a.jsxs("tr",{children:[a.jsx("td",{children:e.cliente_nombre}),a.jsx("td",{children:e.servicio.nombre_servicio}),a.jsx("td",{children:e.descripcion}),a.jsx("td",{children:e.fecha}),a.jsx("td",{children:e.hora}),a.jsx("td",{children:e.cliente_email}),a.jsx("td",{children:e.cliente_telefono}),a.jsx("td",{children:1===e.estado?"Activa":"Cancelada"}),a.jsx("td",{className:"btn_table",children:a.jsx(d,{title:"¿Eliminar cita?",description:"¿Está seguro que desea eliminar esta cita?",onConfirm:()=>b(e.id_cita),onCancel:()=>m.info("Cancelado"),okText:"Sí",cancelText:"No",children:a.jsx("button",{className:"btn_delete",children:a.jsx(i,{})})})})]},r)})]})},{key:"2",label:"Crear cita",children:a.jsx(l,{})},{key:"3",label:"Citas para Hoy",children:a.jsx(a.Fragment,{children:g?a.jsx("p",{children:"Cargando citas de hoy..."}):f?a.jsx("p",{children:"Error al cargar las citas de hoy"}):Array.isArray(C)&&0===C.length?a.jsx("p",{children:"No hay citas programadas para hoy."}):a.jsx(n,{data:C,columns:["Cliente","Servicio","Fecha","Hora","Correo","Teléfono","Estado","Acción"],renderRow:(e,r)=>a.jsxs("tr",{children:[a.jsx("td",{children:e.cliente_nombre}),a.jsx("td",{children:e.servicio.nombre_servicio}),a.jsx("td",{children:e.fecha}),a.jsx("td",{children:e.hora}),a.jsx("td",{children:e.cliente_email}),a.jsx("td",{children:e.cliente_telefono}),a.jsx("td",{children:1===e.estado?"Activa":"Cancelada"}),a.jsxs("td",{className:"btn_table",children:[a.jsx("button",{className:"btn_edit",onClick:()=>alert(`Editar Cita: ${e.cliente_nombre}`),children:a.jsx(s,{})}),a.jsx(d,{title:"¿Eliminar cita?",description:"¿Está seguro que desea eliminar esta cita?",onConfirm:()=>b(e.id_cita),onCancel:()=>m.info("Cancelado"),okText:"Sí",cancelText:"No",children:a.jsx("button",{className:"btn_delete",children:a.jsx(i,{})})})]})]},r)})})}];return y?a.jsx("p",{children:"Cargando..."}):u?a.jsxs("p",{children:["Error: ",u.message]}):a.jsxs(a.Fragment,{children:[a.jsx(c,{titulo:"Gestión Citas"}),a.jsx(o,{items:_})]})}export{h as default};
